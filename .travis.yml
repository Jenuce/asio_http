language: cpp

compiler:
  - clang
  - gcc

install:
  - wget --no-check-certificate https://cmake.org/files/v3.4/cmake-3.4.1.tar.gz
  - tar xf cmake-3.4.1.tar.gz
  - cd cmake-3.4.1 && ./configure && make -j8 && sudo make install > /dev/null
  - cmake --version
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo apt-get update -qq
  - if [ "$CXX" = "g++" ]; then sudo apt-get install -qq g++-5; fi
  - if [ "$CXX" = "g++" ]; then export CXX="g++-5" CC="gcc-5"; fi
  - pip install --user cpp-coveralls

script:
  - cd $TRAVIS_BUILD_DIR
  - mkdir build && cd build
  - cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_VERBOSE_MAKEFILE=TRUE
  - make -j8
  - ./example &
  - PID=$!
  - curl localhost:8080/hello
  - curl localhost:8080/
  - kill $PID
  - coveralls -b tests --exclude deps --verbose

os: linux

sudo: true

# vim:shiftwidth=2
